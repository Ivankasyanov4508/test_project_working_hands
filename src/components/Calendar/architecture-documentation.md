# Архитектура компонента Calendar на Vue 3 - Полная документация

## Обзор

Компонент Calendar представляет собой полнофункциональный календарь для Vue 3 с поддержкой локализации, темизации, кастомизации и двусторонней привязки данных. Архитектура компонента построена на принципах разделения ответственности, обеспечивая масштабируемость, тестируемость и поддерживаемость.

## Структура компонентов

```
Calendar/
├── Calendar.vue (главный компонент-контейнер)
├── CalendarHeader.vue (шапка с навигацией)
├── CalendarGrid.vue (сетка дней)
├── CalendarDay.vue (отдельная ячейка дня)
└── composables/
    └── useCalendar.ts (бизнес-логика)
└── types.ts (TypeScript интерфейсы)
```

## Принципы архитектуры

### 1. Разделение ответственности
- **Calendar.vue** - главный компонент-оркестратор
- **CalendarHeader.vue** - навигационная панель
- **CalendarGrid.vue** - сетка календаря
- **CalendarDay.vue** - атомарный компонент ячейки
- **useCalendar.ts** - бизнес-логика

### 2. Композиция компонентов
Все компоненты построены с использованием Composition API, что обеспечивает лучшую переиспользуемость логики и более гибкую структуру.

### 3. Инкапсуляция логики
Вся бизнес-логика работы с датами инкапсулирована в composable useCalendar.ts, что позволяет легко тестировать и переиспользовать логику.

## Подробное описание компонентов

### useCalendar.ts
Инкапсулирует всю логику работы с датами:

- Состояние: currentMonth, currentYear, selectedDate
- Вычисляемые свойства: daysInMonth, monthName, canNavigatePrev/Next
- Методы: navigateMonth, selectDate, getDaysGrid, isToday, isDisabled

### CalendarDay.vue
Атомарный компонент для отображения одного дня:

- Отображение визуальных состояний (выбран, сегодня, другой месяц, отключен)
- Обработка кликов и эмит событий
- Поддержка клавиатурной навигации
- Доступные элементы интерфейса

### CalendarGrid.vue
Компонент для отображения сетки календаря:

- Отрисовка структуры таблицы (заголовки дней недели)
- Расчет позиционирования дней в сетке
- Отображение дней предыдущего/следующего месяца
- Поддержка слотов для кастомизации дней

### CalendarHeader.vue
Навигационная панель календаря:

- Отображение текущего месяца и года
- Кнопки переключения месяцев
- Опциональные дропдауны для быстрого выбора месяца/года
- Эмит событий навигации

### Calendar.vue (главный компонент)
Компонент-оркестратор:

- Управление состоянием календаря
- Координация взаимодействия дочерних компонентов
- Реализация v-model паттерна
- Поддержка слотов для кастомизации
- Provide конфигурации для дочерних компонентов

## Потоки данных

### Props flow (сверху вниз)
```
Calendar (props: modelValue, minDate, maxDate)
  ↓
  ├→ CalendarHeader (props: month, year, canNavigate*)
  └→ CalendarGrid (props: days[], selectedDate, locale)
      ↓
      └→ CalendarDay (props: day, isSelected, isDisabled)
```

### Events flow (снизу вверх)
```
CalendarDay (@click)
  ↓
CalendarGrid (@day-select)
  ↓
Calendar (@update:modelValue, @select)
  ↓
Parent component
```

## Поддержка v-model

Компонент реализует паттерн v-model для двусторонней привязки даты:

```vue
<Calendar v-model="selectedDate" />
```

## Локализация и темизация

### Provide/Inject
Конфигурация (локализация, форматирование) передается через provide/inject:

```typescript
// Calendar.vue
provide('calendarConfig', config);

// В дочерних компонентах
const config = inject('calendarConfig');
```

### Поддержка слотов
Компонент поддерживает слоты для кастомизации:

- `#header` - полная замена шапки
- `#day` - кастомная отрисовка ячейки дня
- `#navigation` - замена кнопок навигации
- `#footer` - добавление футера

## TypeScript поддержка

Все компоненты и composable имеют полную типизацию:

- CalendarDay - структура объекта дня
- CalendarConfig - настройки календаря
- DateRange - ограничения дат
- CalendarEmits - типизация событий

## Архитектурные преимущества

### 1. Масштабируемость
- Легко добавить функционал (диапазоны дат, мультивыбор, события на датах)
- Компоненты слабо связаны, что упрощает расширение

### 2. Тестируемость
- Каждый компонент и composable тестируется изолированно
- Четкие интерфейсы для тестирования потоков данных

### 3. Переиспользование
- CalendarDay и composable можно использовать в других контекстах
- Вся логика тестируется отдельно от UI

### 4. Поддерживаемость
- Четкое разделение ответственности упрощает отладку
- Легко находить и исправлять ошибки в конкретных компонентах

### 5. Производительность
- Мелкие компоненты позволяют Vue эффективно обновлять только измененные части
- Вычисляемые свойства предотвращают ненужные перерасчеты

### 6. Расширяемость
- Слоты и provide/inject дают гибкость без изменения кода
- Возможность кастомизации внешнего вида и поведения

## Использование

### Простое использование
```vue
<template>
  <Calendar v-model="selectedDate" />
</template>

<script setup lang="ts">
import { ref } from 'vue';
import Calendar from './components/Calendar.vue';

const selectedDate = ref(new Date());
</script>
```

### С ограничениями
```vue
<template>
  <Calendar 
    v-model="selectedDate"
    :min-date="minDate"
    :max-date="maxDate"
    locale="ru-RU"
    @select="onDateSelect"
  />
</template>
```

### С кастомизацией
```vue
<template>
  <Calendar 
    v-model="selectedDate"
    :locale="locale"
  >
    <template #header="{ month, year }">
      <div class="custom-header">
        <h3>{{ month }} {{ year }}</h3>
      </div>
    </template>
    
    <template #day="{ day, isSelected, isToday }">
      <div class="custom-day" :class="{ selected: isSelected, today: isToday }">
        {{ day.date.getDate() }}
      </div>
    </template>
  </Calendar>
</template>
```

## Заключение

Разработанная архитектура компонента календаря обеспечивает:

- Четкое разделение ответственности между компонентами
- Полноценную поддержку TypeScript
- Гибкую систему кастомизации через слоты
- Эффективную передачу данных через props и события
- Поддержку локализации через provide/inject
- Совместимость с v-model паттерном
- Масштабируемость и поддерживаемость кода

Архитектура позволяет легко расширять функциональность календаря, добавлять новые возможности и кастомизировать внешний вид без изменения основной логики компонента.